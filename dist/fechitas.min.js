/*! fechitas - v0.5.0 - 2015-03-08
* https://jaimerodas.github.io/fechitas
* Copyright (c) 2015 Jaime Rodas; Licensed MIT */
!function(a,b,c){function d(a){return 10>a?"0"+a:a}function e(a){return a.charAt(0).toUpperCase()+a.slice(1)}function f(a,b){return/8|3|5|10/.test(b)?30:1!=b?31:a%4===0&&a%100!==0||a%400===0?29:28}function g(b,d){var e=c.createElement(b);return d&&(e.id=y+d),a(e)}function h(a){var b=g("div",a).attr("class",y+"panel").append(g("div").attr("class",y+"nav"));if("month"==a){var c=g("div","week");E.forEach(function(a){c.append(g("div").attr("class",y+"weekday").text(a))}),b.append(c)}return b.append(g("div").attr("class",y+"els")),b}function i(a){v.find(A+"panel").hide(),v.find(z+a).show()}function j(){var b=a("#"+y+"container");b.length||(b=g("div","container").append(g("div","box").append(h("decade"),h("year"),h("month"))),a(c.body).append(b))}function l(a){a=a.toString();var b,c,d=v.find(z+"decade"),e=d.children(A+"els").html(""),f=d.children(A+"nav").html("");for(b=3==a.length?a:a.substr(0,3),c=0;10>c;c++){var h=g("button").attr({"class":y+"chooseYear",value:b+c,type:"button"}).text(b+c);b+c==a&&h.addClass(y+"active"),e.append(h)}b=parseInt(b,10),f.append(g("button").attr({value:b-1,type:"button"}).addClass(y+"chooseDecade",y+"choose").text(b-1+"0's"),g("button").attr({value:b+1,type:"button"}).addClass(y+"chooseDecade",y+"choose").text(b+1+"0's"))}function m(){var a=u.getFullYear().toString(),b=u.getMonth(),c=v.find(z+"year"),d=c.children(A+"els").html(""),f=c.children(A+"nav").html(""),h=a.toString().substr(0,3);C.forEach(function(a,c){var f=g("button").attr({"class":y+"chooseMonth",type:"button",value:c}).text(e(a));c==b&&f.addClass(y+"active"),d.append(f)}),f.append(g("button").attr({"class":y+"chooseDecade",type:"button",value:h}).text(a))}function n(){var a,b,c=u.getFullYear().toString(),d=u.getMonth(),h=u.getDate(),i=c.substr(0,3),j=f(c,d),l=v.find(z+"month"),m=l.children(A+"els").html(""),n=l.children(A+"nav").html("");if(b=new Date(c,d,1),b=b.getDay(),b>0)for(k=0;k<b;k++)m.append(g("div").addClass("empty"));for(a=1;j>=a;a++){var o=g("button").attr({type:"button","class":y+"chooseDay",value:a}).text(a);a==h&&o.addClass(y+"active"),m.append(o)}n.append(g("button").attr({type:"button","class":y+"chooseDecade",value:i}).text(c),g("button").attr({type:"button","class":y+"chooseYear",value:c}).text(e(C[d])))}function o(){var a=s.data(y+"date"),b=s.get(0).nodeName.toLowerCase();return a||("input"==b?(s.attr("type","text"),a=s.val()):a=s.html(),a=new Date(a),(""===a||"[object Date]"!==Object.prototype.toString.call(a)||isNaN(a.getTime()))&&(a=new Date)),("[object Date]"!==Object.prototype.toString.call(a)||isNaN(a.getTime()))&&(a=new Date(a)),0!==a.getTimezoneOffset()&&(ldate=new Date,ldate.setTime(a.getTime()+60*a.getTimezoneOffset()*1e3),a=ldate),a}function p(){if(!w){w=!0;var b=s.get(0).nodeName.toLowerCase(),c=a.fn.fechitas.format(u,t);s.data(y+"date",u),"input"==b?s.val(c):s.text(c),s.trigger("fechitasDateChange")}}function q(){v.click(function(){t=s=u=null,a(this).removeClass(y+"visible")}),v.on("click",A+"chooseDay",function(){var b=a(this).val();u.setDate(b),p()}),v.on("click",A+"chooseMonth",function(b){var c=a(this).val();return u.setMonth(c),"month"!=t.type?(n(),i("month"),void b.stopPropagation()):(u.setDate(1),void p())}),v.on("click",A+"chooseYear",function(b){var c=a(this).val();u.setFullYear(c),m(),i("year"),b.stopPropagation()}),v.on("click",A+"chooseDecade",function(b){var c=a(this).val();l(c),i("decade"),b.stopPropagation()})}function r(b){w=!1,s=b,t=s.data(y+"settings"),u=s.data(y+"date"),v=a(z+"container").addClass(y+"visible"),l(u.getFullYear()),m(),"month"==t.type?i("year"):(n(),i("month")),q()}var s,t,u,v,w=!1,x="fechitas",y=x+"-",z="#"+y,A="."+y,B={type:"day",format:"normal",capitalized:!1,hideOnMobile:!0},C=["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"],D=["ene","feb","mar","abr","may","jun","jul","ago","sep","oct","nov","dic"],E=["D","L","M","M","J","V","S"];a(j),a.fn.fechitas=function(b){return this.each(function(){return s=a(this),t=a.extend({},B,b),t.hideOnMobile&&/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)?this:(u=o(),s.addClass("has"+e(x)).data(y+"settings",t).data(y+"date",u),s.click(function(){r(a(this))}),s)})},a.fn.fechitas.format=function(b,c){var f,g=a.extend({},{type:"day",format:"normal",capitalized:!1},c),h="invalid format",i="-";switch("verbose"==g.format&&(f=D[b.getMonth()]),"veryverbose"==g.format&&(f=C[b.getMonth()],i=" "),"verbose"!=g.format&&"veryverbose"!=g.format||!g.capitalized||(f=e(f)),g.format){case"normal":h=b.getFullYear()+i+d(b.getMonth()+1);break;case"inverse":h=d(b.getMonth()+1)+i+b.getFullYear();break;case"verbose":case"veryverbose":h=f+i+b.getFullYear()}return"day"==g.type&&("normal"==g.format?h+=i+d(b.getDate()):h=d(b.getDate())+i+h),h}}(jQuery,window,document);